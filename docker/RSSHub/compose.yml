#echo "
version: '3.8'

services:
  freshrss:
    image: jaraim/freshrss:latest
    restart: always
    ports:
      - 8081:80
    logging:
      options:
        max-size: 10m
    volumes:
      - data:/var/www/FreshRSS/data
    environment:
      TZ: Europe/Paris
      CRON_MIN: '2,32'
      FRESHRSS_ENV: development
      FRESHRSS_API_URL: https://your-rsshub-url/api/v1/feeds
      FRESHRSS_API_KEY: your-rsshub-api-key

  rsshub:
     image: jaraim/rsshub:latest
     restart: always
     ports:
      - '1200:1200'
     environment:
      NODE_ENV: production
      CACHE_TYPE: redis
      REDIS_URL: 'redis://redis:6379/'
      PROXY_URI: 'socks5h://warp-socks:9091'
     depends_on:
      - redis

  redis:
     image: jaraim/redis:latest
     restart: always
     volumes:
     - redis:/data
  
  warp-socks:
    image: monius/docker-warp-socks:latest
    privileged: true
    volumes:
      - /lib/modules:/lib/modules
    cap_add:
      - NET_ADMIN
      - SYS_ADMIN
    sysctls:
      net.ipv6.conf.all.disable_ipv6: 0
      net.ipv4.conf.all.src_valid_mark: 1
    healthcheck:
      test: ["CMD", "curl", "-f", "https://www.cloudflare.com/cdn-cgi/trace"]
      interval: 30s
      timeout: 10s
      retries: 5
volumes:
    freshrss:
    data:
    rsshub:
    redis:
    warp-socks:
 #" > compose.yml
